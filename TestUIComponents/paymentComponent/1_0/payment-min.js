var anetPay=angular.module("anetPayment",[]);anetPay.directive("anetPaymentForm",["$window",function(b){function a(c){var e=document.createElement("link");e.href="scripts/components/paymentComponent/1_0/assets/paymentForm.css";e.rel="stylesheet";var d=document.getElementsByTagName("head")[0].getElementsByTagName("link").length-1;var f=angular.element(document.getElementsByTagName("head")[0].getElementsByTagName("link")[d]);angular.element(e).insertAfter(f);c.isValidCreditCard=true;c.isValidExpDate=true;c.isBrowserIE9=function(){var h=b.document;var g=(!!h.documentMode)?((h.documentMode===9)?true:false):false;return g};c.getIE9LabelClass=function(g,i){var h=g===true?"ie9FocusInLabelClass label-color":"ie9FocusOutLabelClass";h=i===false?"ie9FocusInErrorLabelClass":h;return h}}a.$inject=["$scope"];return{restrict:"E",templateUrl:"scripts/components/paymentComponent/1_0/assets/PaymentForm.html",scope:{opt:"="},replace:true,controller:a}}]);anetPay.directive("showCardImage",[function(){function a(d,c,b){d.getCardIssuerImagePosition=function(){var e=d.getCardIssuer(d.opt.creditCard.model);if(d.isValidCreditCard){return e}else{return"-242px"}};d.getCardIssuer=function(e){e=typeof(e)!="undefined"?e.replace(/\s*/g,""):"";if(/^4[0-9]{6,}$/.test(e)){return"2px"}else{if(/^5[1-5][0-9]{5,}$/.test(e)){return"-29px"}else{if(/^6(?:011|5[0-9]{2})[0-9]{3,}$/.test(e)){return"-90px"}else{if(/^3(?:0[0-5]|[68][0-9])[0-9]{11}$/.test(e)){return"-151px"}else{if(/^3[47][0-9]{5,}$/.test(e)){return"-59px"}else{if(/^(?:2131|1800|35\d{3})\d{11}$/.test(e)){return"-121px"}else{return"-182px"}}}}}}}}a.$inject=["$scope","$element","$attrs"];return{restrict:"A",template:'<div id="cardiconimg"  ng-attr-style="background: url(scripts/components/paymentComponent/1_0/assets/icons.png);background-position: {{getCardIssuerImagePosition()}};" class="CCImage"></div>',controller:a}}]);anetPay.directive("creditcardDirective",["$timeout",function(b){function a(e,d,c){e.creditCardFocusOut=function(){e.hasCardFocus=false;angular.element("#cardNum").removeClass("bg-border-color");if(e.opt.creditCard.model.split(" ").join("").length<13||(!e.luhnCheck())){e.isValidCreditCard=false}if(e.opt.creditCard.model===0&&e.isValidCreditCard){angular.element("#cardNum").attr("placeholder","")}};e.getCreditCardClass=function(){var f=e.isValidCreditCard===false?"inValidBorderBottom":"";return f};e.creditCardFocusIn=function(){e.hasCardFocus=true;angular.element("#cardNum").attr("placeholder","1234 5678 9012 3456");if(e.opt.creditCard.model&&e.opt.creditCard.model.indexOf("XXXX")==0){e.opt.creditCard.model="";e.isValidCreditCard=true}if(e.isValidCreditCard===true){angular.element("#cardNum").addClass("bg-border-color")}};e.cardNumChange=function(){var f=String(e.opt.creditCard.model).replace(/[^0-9*]+/g,"");e.opt.creditCard.model=e.formateNumber(f);f=e.opt.creditCard.model.replace(/[^0-9*]+/g,"");if(((/^4[0-9]{6,}$/.test(f))||(/^5[1-5][0-9]{5,}$/.test(f))||(/^6(?:011|5[0-9]{2})[0-9]{3,}$/.test(f))||(/^(?:2131|1800|35\d{3})\d{11}$/.test(f)))&&f.length===16){e.moveFocus()}else{if(/^3[47][0-9]{5,}$/.test(f)&&f.length===15){e.moveFocus()}else{if(/^3(?:0[0-5]|[68][0-9])[0-9]{11}$/.test(f)&&f.length===14){e.moveFocus()}}}};e.moveFocus=function(){var f=e.luhnCheck();e.isValidCreditCard=f;if(f){b(function(){angular.element("#expiryDate").focus()})}};e.getInputFieldClass=function(){var f=(e.hasCardFocus===true||e.opt.creditCard.model.length!==0)?"floating-placeholder-float-cc floating-placeholder-cc":(e.isValidCreditCard===true?"floating-placeholder-cc":"floating-placeholder-float-cc floating-placeholder-cc");return f};e.getCardLabelClass=function(){var f="";if(e.hasCardFocus===undefined){if(e.opt.creditCard.model.length!==0){f="cardScaleundefinedeffect"}else{f="cardScaleundefinedEmptyeffect"}}else{if(e.hasCardFocus===true){f="cardScaleundefinedeffect label-color"}else{f="cardScaleundefinedeffect cardfocuscolorGreyEffect"}}if(e.isValidCreditCard===false){f="errorLabelColor"}return f};e.luhnCheck=function(){var j=0,i=0,f=false,h=e.opt.creditCard.model.replace(/\D/g,"");for(var k=h.length-1;k>=0;k--){var g=h.charAt(k);i=parseInt(g,10);if(f){if((i*=2)>9){i-=9}}j+=i;f=!f}if((j%10)!==0){return false}return true};e.formateNumber=function(j){if(!j){return""}j=String(j);var i=j;if(/^4[0-9]{6,}$/.test(j)){var n=j.substring(0,4);var D=j.substring(4,8);var w=j.substring(8,12);var u=j.substring(12,16);e.isValidCreditCard=true;if(n){i=n}if(D){i+=(" "+D)}if(w){i+=(" "+w)}if(u){i+=(" "+u)}}if(/^5[1-5][0-9]{5,}$/.test(j)){var h=j.substring(0,4);var k=j.substring(4,8);var q=j.substring(8,12);var o=j.substring(12,16);e.isValidCreditCard=true;if(h){i=h}if(k){i+=(" "+k)}if(q){i+=(" "+q)}if(o){i+=(" "+o)}}if(/^6(?:011|5[0-9]{2})[0-9]{3,}$/.test(j)){var t=j.substring(0,4);var v=j.substring(4,8);var B=j.substring(8,12);var z=j.substring(12,16);e.isValidCreditCard=true;if(t){i=t}if(v){i+=(" "+v)}if(B){i+=(" "+B)}if(z){i+=(" "+z)}}if(/^3(?:0[0-5]|[68][0-9])[0-9]{11}$/.test(j)){var f=j.substring(0,4);var x=j.substring(4,8);var p=j.substring(8,12);var m=j.substring(12,14);e.isValidCreditCard=true;if(f){i=f}if(x){i+=(" "+x)}if(p){i+=(" "+p)}if(m){i+=(" "+m)}}if(/^(?:2131|1800|35\d{3})\d{11}$/.test(j)){var s=j.substring(0,4);var C=j.substring(4,8);var A=j.substring(8,12);var y=j.substring(12,16);e.isValidCreditCard=true;if(s){i=s}if(C){i+=(" "+C)}if(A){i+=(" "+A)}if(y){i+=(" "+y)}}if(/^3[47][0-9]{5,}$/.test(j)){var l=j.substring(0,4);var g=j.substring(4,10);var r=j.substring(10,15);e.isValidCreditCard=true;if(l){i=l}if(g){i+=(" "+g)}if(r){i+=(" "+r)}}return i}}a.$inject=["$scope","$element","$attrs"];return{restrict:"E",scope:false,template:'<input type="tel" id="cardNum" name="cardNum" ng-model="opt.creditCard.model"  my-maxlength="19"  ng-focus="creditCardFocusIn()" ng-blur="creditCardFocusOut()" ng-change="cardNumChange()" autocomplete="off"  autocorrect="off" autocapitalize="off" ng-class="getCreditCardClass()">',controller:a}}]);anetPay.directive("expDate",["$timeout",function(b){function a(e,d,c){e.testExpDate=function(h){var l=h.split("/");var g=/^(0[1-9]|1[012])$/;var j=l[0];var i=l[1];if(!g.exec(j)){return false}var f,k;f=new Date();if(i===undefined){return false}i=i.length==2?20+i:i;k=new Date(i,j,0);if(k<f){return false}return true};e.expDateFocusIn=function(){e.hasExpiryFocus=true;angular.element("#expiryDate").attr("placeholder",e.opt.expDate.placeHolder);if(e.isValidExpDate===true){angular.element("#expiryDate").addClass("bg-border-color")}};e.getExpInputFieldClass=function(){return(e.hasExpiryFocus===true||e.opt.expDate.model.length!==0||e.isValidExpDate===false?"floating-placeholder-float floating-placeholder":"floating-placeholder")};e.getExpDateLabelClass=function(f,h){var g=f===true?"focuscolorEffect label-color":"focuscolorGreyEffect";g=h===false?"errorLabelColor":g;return g};e.getExpDateClass=function(){var f=e.isValidExpDate===false?"inValidBorderBottom text-intent":"text-intent";return f};e.expDateFocusOut=function(){e.hasExpiryFocus=false;angular.element("#expiryDate").removeClass("bg-border-color");if(e.opt.expDate.model!==undefined&&e.opt.expDate.model.length===0){angular.element("#expiryDate").attr("placeholder",e.opt.expDate.placeHolder);e.isValidExpDate=false}else{if(!e.testExpDate(e.opt.expDate.model)){e.isValidExpDate=false}else{e.isValidExpDate=true}}}}a.$inject=["$scope","$element","$attrs"];return{restrict:"E",scope:false,replace:true,controller:a,template:'<input type="tel" name="expiryDate" id="expiryDate" autocomplete="off"  autocorrect="off" autocapitalize="off" ng-focus = "expDateFocusIn()"  ng-blur="expDateFocusOut()" ng-model="opt.expDate.model" my-maxlength="5" ng-click="hasExpiryFocus=true"  ng-class="getExpDateClass()" ></input>',link:function(e,d,c){e.$watch("opt.expDate.model",function(i,f){if(e.opt.expDate.model===undefined||e.opt.expDate.model===""){return}var h=e.opt.expDate.model;var k=h.split("/");var j=k[0];var g=k[1]!==undefined?k[1]:"";j=isNaN(j)?j.substring(0,j.length-1):j;g=isNaN(g)?g.substring(0,g.length-1):g;h=h.replace(/[^0-9]+/g,"");switch(h.length){case 1:if(j>1&&j<=9){j="0"+j}break;case 2:if(f.length==3){j=j.substring(0,1)}else{if(j>12||parseInt(j)<=0){j=j.substring(0,j.length-1)}}break;case 3:if(g==="0"){g=""}break;case 4:if(!e.testExpDate(e.opt.expDate.model)){g=g.substring(0,g.length-1)}else{e.isValidExpDate=true;b(function(){angular.element("#cvv").focus()})}break}if(j.length===2){j=j+"/"}e.opt.expDate.model=j+g})}}}]);anetPay.directive("myMaxlength",["$compile",function(a){return{restrict:"A",require:"ngModel",link:function(d,e,b,f){var c=parseInt(b.myMaxlength,10);f.$parsers.push(function(g){if(g.length>c){g=g.substr(0,c);f.$setViewValue(g);f.$render()}return g})}}}]);anetPay.directive("cvvInput",[function(){function a(d,c,b){d.validateCVV=function(){d.opt.cvv.model=d.opt.cvv.model.replace(/[^0-9]+/g,"")};d.cvvFocusIn=function(){angular.element("#cvv").attr("placeholder",d.opt.cvv.placeHolder);d.hasCVVFocus=true;angular.element("#cvv").addClass("bg-border-color")};d.getCVVLabelClass=function(e,g){var f=e===true?"focuscolorEffect label-color":"focuscolorGreyEffect";return f};d.getCVVInputFieldClass=function(){var e=d.hasCVVFocus===true||d.opt.cvv.model.length!==0?"floating-placeholder-float floating-placeholder":"floating-placeholder";return e};d.getCVVClass=function(){var e=d.isCVVMandatory===true?"inValidBorderBottom text-intent":"text-intent";return e};d.cvvFocusOut=function(){d.hasCVVFocus=false;angular.element("#cvv").removeClass("bg-border-color");if(d.opt.cvv.model.length===0){angular.element("#cvv").attr("placeholder","")}d.isCVVMandatory=d.opt.cvv.isRequired&&d.opt.cvv.model.length===0&&d.opt.cvv.isReadonly===false?true:false}}a.$inject=["$scope","$element","$attrs"];return{restrict:"E",scope:false,replace:true,template:'<div><input id="cvv" ng-focus="cvvFocusIn()" ng-blur="cvvFocusOut()" ng-model="opt.cvv.model" my-maxlength="5" name="cvv" type="tel" autocomplete="off"  autocorrect="off" autocapitalize="off" ng-change="validateCVV()" ng-readonly="opt.cvv.isReadonly" ng-class="getCVVClass()"></input></div>',controller:a}}]);